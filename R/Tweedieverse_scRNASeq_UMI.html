<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Himel Mallick" />

<meta name="date" content="2022-02-26" />

<title>Using the Tweedieverse package for differential expression of scRNA-Seq UMI counts</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Using the Tweedieverse package for differential expression of scRNA-Seq UMI counts</h1>
<h4 class="author">Himel Mallick</h4>
<h4 class="date">2022-02-26</h4>



<p>This vignette highlights some example workflows for performing differential expression using <code>Tweedieverse</code> on single-cell RNA-seq (scRNA-seq) <a href="https://en.wikipedia.org/wiki/Unique_molecular_identifier">UMI counts</a> (check out the related tutorial for <a href="http://htmlpreview.github.io/?https://github.com/himelmallick/TweedieLabs/blob/main/R/Tweedieverse_scRNASeq_nonUMI.html">scRNA-seq non-UMI counts</a>). It should be noted that <code>Tweedieverse</code> is a sister package of <a href="https://huttenhower.sph.harvard.edu/maaslin/">MaAsLin</a> which is developed by many of the same authors as this package and likewise, they share certain similarities but also important differences as described in details in the in-depth <a href="https://github.com/himelmallick/TweedieLabs">tutorials</a>.</p>
<div id="install-and-load-packages" class="section level2">
<h2>Install and load packages</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Load the Tweedieverse package</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(Tweedieverse)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co"># Load other essential packages</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">library</span>(Seurat)</a></code></pre></div>
</div>
<div id="input" class="section level2">
<h2>Input</h2>
<p><code>Tweedieverse</code> requires two tab-delimited input files, one for expression counts (<code>input_features</code>) and one for metadata or covariates (<code>input_metadata</code>). The rows of the <code>input_features</code> correspond to genes and the columns correspond to cells (and vice versa). Similarly, the columns of the <code>input_metadata</code> correspond to cell-specific covariates (e.g., cell types) and the rows correspond to cells.</p>
<p>The <code>input_features</code> file can contain cells not included in the <code>input_metadata</code> file (along with the reverse case) although it is expected that they have matching cells. For both cases, cells not included in either of the files will be removed from the analysis. Also cells do not need to be in the same order in the two files as <code>Tweedieverse</code> will automatically detect the right order based on the cell names (assuming common cell IDs across files).</p>
<p>For the purpose of this vignette, it is assumed that these two input data have already been quality-controlled with necessary preprocessing steps, e.g.,, as described in the <a href="https://satijalab.org/seurat/articles/essential_commands.html">Seurat tutorial</a>. For demonstration purposes, we will be using a cleaned version of the PBMC dataset (freely available from the <a href="https://s3-us-west-2.amazonaws.com/10x.files/samples/cell/pbmc3k/pbmc3k_filtered_gene_bc_matrices.tar.gz">10x genomics website</a>) that was pre-processed using <a href="https://satijalab.org/seurat/"><code>Seurat</code></a>. The pre-computed <code>Seurat</code> object can be downloaded from <a href="https://www.dropbox.com/s/63gnlw45jf7cje8/pbmc3k_final.rds?dl=1">here</a>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co"># Download file</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">download.file</span>(<span class="st">&quot;https://www.dropbox.com/s/63gnlw45jf7cje8/pbmc3k_final.rds?dl=1&quot;</span>, <span class="st">&quot;pbmc3k_final.rds&quot;</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co"># Load the PBMC Seurat object </span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">pbmc &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">&quot;pbmc3k_final.rds&quot;</span>)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co"># Subset to CD4 and CD8 cell types</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">keepcells =<span class="st"> </span><span class="kw">as.integer</span>(pbmc<span class="op">@</span>active.ident) <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb2-10" data-line-number="10"></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co"># Extract expression counts</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12">counts =<span class="st"> </span>pbmc<span class="op">@</span>assays<span class="op">$</span>RNA<span class="op">@</span>counts[, keepcells]</a>
<a class="sourceLine" id="cb2-13" data-line-number="13">counts =<span class="st"> </span><span class="kw">as.matrix</span>(counts)</a>
<a class="sourceLine" id="cb2-14" data-line-number="14"></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co"># Extract covariate (celltype) information</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16">clusters =<span class="st"> </span><span class="kw">as.integer</span>(pbmc<span class="op">@</span>active.ident)</a>
<a class="sourceLine" id="cb2-17" data-line-number="17">clusters =<span class="st"> </span>clusters[clusters <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>)]</a>
<a class="sourceLine" id="cb2-18" data-line-number="18">cData =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">seurat =</span> clusters)</a>
<a class="sourceLine" id="cb2-19" data-line-number="19">cData<span class="op">$</span>seurat&lt;-<span class="kw">ifelse</span>(cData<span class="op">$</span>seurat<span class="op">==</span><span class="dv">5</span>, <span class="st">'CD8'</span>, <span class="st">'CD4'</span>)</a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="kw">rownames</span>(cData) =<span class="st"> </span><span class="kw">colnames</span>(counts)</a>
<a class="sourceLine" id="cb2-21" data-line-number="21"></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co"># Prepare data for Tweedieverse</span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23">input_features&lt;-<span class="kw">as.data.frame</span>(<span class="kw">t</span>(counts))</a>
<a class="sourceLine" id="cb2-24" data-line-number="24">input_metadata&lt;-cData</a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="kw">names</span>(input_metadata)&lt;-<span class="st">'CellType'</span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26">input_metadata<span class="op">$</span>CellType&lt;-<span class="kw">as.factor</span>(input_metadata<span class="op">$</span>CellType)</a>
<a class="sourceLine" id="cb2-27" data-line-number="27">input_metadata<span class="op">$</span>CellType&lt;-<span class="kw">factor</span>(input_metadata<span class="op">$</span>CellType, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">'CD8'</span>, <span class="st">'CD4'</span>))</a>
<a class="sourceLine" id="cb2-28" data-line-number="28"></a>
<a class="sourceLine" id="cb2-29" data-line-number="29"><span class="co"># Take a quick look at the data</span></a>
<a class="sourceLine" id="cb2-30" data-line-number="30"><span class="kw">head</span>(input_features[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</a>
<a class="sourceLine" id="cb2-31" data-line-number="31"><span class="co">#&gt;                AL627309.1 AP006222.2 RP11-206L10.2 RP11-206L10.9 LINC00115</span></a>
<a class="sourceLine" id="cb2-32" data-line-number="32"><span class="co">#&gt; AAACATACAACCAC          0          0             0             0         0</span></a>
<a class="sourceLine" id="cb2-33" data-line-number="33"><span class="co">#&gt; AAACATTGATCAGC          0          0             0             0         0</span></a>
<a class="sourceLine" id="cb2-34" data-line-number="34"><span class="co">#&gt; AAACGCACTGGTAC          0          0             0             0         0</span></a>
<a class="sourceLine" id="cb2-35" data-line-number="35"><span class="co">#&gt; AAACGCTGACCAGT          0          0             0             0         0</span></a>
<a class="sourceLine" id="cb2-36" data-line-number="36"><span class="co">#&gt; AAACGCTGGTTCTT          0          0             0             0         0</span></a>
<a class="sourceLine" id="cb2-37" data-line-number="37"><span class="kw">head</span>(input_metadata)</a>
<a class="sourceLine" id="cb2-38" data-line-number="38"><span class="co">#&gt;                CellType</span></a>
<a class="sourceLine" id="cb2-39" data-line-number="39"><span class="co">#&gt; AAACATACAACCAC      CD4</span></a>
<a class="sourceLine" id="cb2-40" data-line-number="40"><span class="co">#&gt; AAACATTGATCAGC      CD4</span></a>
<a class="sourceLine" id="cb2-41" data-line-number="41"><span class="co">#&gt; AAACGCACTGGTAC      CD4</span></a>
<a class="sourceLine" id="cb2-42" data-line-number="42"><span class="co">#&gt; AAACGCTGACCAGT      CD8</span></a>
<a class="sourceLine" id="cb2-43" data-line-number="43"><span class="co">#&gt; AAACGCTGGTTCTT      CD8</span></a>
<a class="sourceLine" id="cb2-44" data-line-number="44"><span class="co">#&gt; AAACGCTGTAGCCA      CD4</span></a>
<a class="sourceLine" id="cb2-45" data-line-number="45"></a>
<a class="sourceLine" id="cb2-46" data-line-number="46"><span class="co"># Calculate sparsity (percentage of zeroes)</span></a>
<a class="sourceLine" id="cb2-47" data-line-number="47"><span class="kw">round</span>(<span class="kw">sum</span>(input_features<span class="op">==</span><span class="dv">0</span>)<span class="op">/</span>(<span class="kw">nrow</span>(input_features)<span class="op">*</span><span class="kw">ncol</span>(input_features))<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-48" data-line-number="48"><span class="co">#&gt; [1] 94.1</span></a></code></pre></div>
<p>For brevity, we will consider top 100 most variable genes.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">sds&lt;-<span class="kw">apply</span>(input_features, <span class="dv">2</span>, <span class="cf">function</span>(x){<span class="kw">sd</span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)})</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">top_n_IDs&lt;-<span class="kw">order</span>(sds, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>]</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">input_features&lt;-input_features[, top_n_IDs]</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw">dim</span>(input_features)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; [1] 1451  100</span></a></code></pre></div>
</div>
<div id="normalization" class="section level2">
<h2>Normalization</h2>
<p>For normalization, Tweedieverse expects a variable named <code>scale_factor</code> in the <code>input_metadata</code> file which is included as an offset in the base model when prompted (i.e. <code>adjust_offset = TRUE</code>). If not found in metadata, Tweedieverse, by default, includes the library size as an offset in the model (unless <code>adjust_offset = FALSE</code>). Here we use the CPLM base model with library size normalization (see the related tutorial for <a href="http://htmlpreview.github.io/?https://github.com/himelmallick/TweedieLabs/blob/main/R/Tweedieverse_scRNASeq_nonUMI.html">non-UMI counts</a> for using other normalization methods).</p>
</div>
<div id="differential-expression" class="section level2">
<h2>Differential Expression</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="cf">if</span> (<span class="op">!</span><span class="kw">dir.exists</span>(<span class="st">'demo_output'</span>)) <span class="kw">dir.create</span>(<span class="st">'demo_output'</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">PBMC &lt;-<span class="st"> </span><span class="kw">Tweedieverse</span>(</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">  input_features,</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">  input_metadata, </a>
<a class="sourceLine" id="cb4-5" data-line-number="5">  <span class="dt">output =</span> <span class="st">'demo_output/PBMC'</span>, <span class="co"># Assuming demo_output exists</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">  <span class="dt">fixed_effects =</span> <span class="kw">c</span>(<span class="st">'CellType'</span>),</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">  <span class="dt">base_model =</span> <span class="st">'CPLM'</span>,</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">  <span class="dt">adjust_offset =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; [1] &quot;Warning: Deleting existing log file: demo_output/PBMC/Tweedieverse.log&quot;</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt; 2022-02-26 14:34:50 INFO::Writing function arguments to log file</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt; 2022-02-26 14:34:50 INFO::Determining format of input files</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; 2022-02-26 14:34:50 INFO::Input format is data samples as rows and metadata samples as rows</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt; 2022-02-26 14:34:50 INFO::Factor detected for categorial metadata 'CellType'. Provide a reference argument or manually set factor ordering to change reference level.</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt; 2022-02-26 14:34:50 INFO::Filter data based on min abundance and min prevalence</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; 2022-02-26 14:34:50 INFO::Total samples in data: 1451</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt; 2022-02-26 14:34:50 INFO::Min samples required with min abundance for a feature not to be filtered: 145.100000</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt; 2022-02-26 14:34:50 INFO::Total filtered features with prevalence-abundance filtering: 0</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt; 2022-02-26 14:34:50 INFO::Filtered feature names:</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt; 2022-02-26 14:34:50 INFO::Total filtered features with variance filtering: 0</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#&gt; 2022-02-26 14:34:50 INFO::Filtered feature names:</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt; 2022-02-26 14:34:50 INFO::Excluded metadata with entropy less or equal to 0:</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt; 2022-02-26 14:34:50 INFO::Formula for fixed effects: expr ~  CellType</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt; 2022-02-26 14:34:50 INFO::Applying z-score to standardize continuous metadata</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co">#&gt; 2022-02-26 14:34:50 INFO::Running selected analysis method: CPLM</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="co">#&gt; 2022-02-26 14:34:50 INFO::Fitting model to feature number 1, MALAT1</span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="co">#&gt; 2022-02-26 14:34:50 INFO::Fitting model to feature number 2, B2M</span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="co">#&gt; 2022-02-26 14:34:51 INFO::Fitting model to feature number 3, TMSB4X</span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"><span class="co">#&gt; 2022-02-26 14:34:51 INFO::Fitting model to feature number 4, RPL13</span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="co">#&gt; 2022-02-26 14:34:51 INFO::Fitting model to feature number 5, RPL10</span></a>
<a class="sourceLine" id="cb4-30" data-line-number="30"><span class="co">#&gt; 2022-02-26 14:34:51 INFO::Fitting model to feature number 6, RPL13A</span></a>
<a class="sourceLine" id="cb4-31" data-line-number="31"><span class="co">#&gt; 2022-02-26 14:34:51 INFO::Fitting model to feature number 7, RPS6</span></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"><span class="co">#&gt; 2022-02-26 14:34:52 INFO::Fitting model to feature number 8, RPS2</span></a>
<a class="sourceLine" id="cb4-33" data-line-number="33"><span class="co">#&gt; 2022-02-26 14:34:52 INFO::Fitting model to feature number 9, RPS18</span></a>
<a class="sourceLine" id="cb4-34" data-line-number="34"><span class="co">#&gt; 2022-02-26 14:34:52 INFO::Fitting model to feature number 10, RPL19</span></a>
<a class="sourceLine" id="cb4-35" data-line-number="35"><span class="co">#&gt; 2022-02-26 14:34:52 INFO::Fitting model to feature number 11, RPS3</span></a>
<a class="sourceLine" id="cb4-36" data-line-number="36"><span class="co">#&gt; 2022-02-26 14:34:52 INFO::Fitting model to feature number 12, RPL3</span></a>
<a class="sourceLine" id="cb4-37" data-line-number="37"><span class="co">#&gt; 2022-02-26 14:34:52 INFO::Fitting model to feature number 13, RPS12</span></a>
<a class="sourceLine" id="cb4-38" data-line-number="38"><span class="co">#&gt; 2022-02-26 14:34:52 INFO::Fitting model to feature number 14, ACTB</span></a>
<a class="sourceLine" id="cb4-39" data-line-number="39"><span class="co">#&gt; 2022-02-26 14:34:53 INFO::Fitting model to feature number 15, RPL11</span></a>
<a class="sourceLine" id="cb4-40" data-line-number="40"><span class="co">#&gt; 2022-02-26 14:34:53 INFO::Fitting model to feature number 16, RPL32</span></a>
<a class="sourceLine" id="cb4-41" data-line-number="41"><span class="co">#&gt; 2022-02-26 14:34:53 INFO::Fitting model to feature number 17, RPLP1</span></a>
<a class="sourceLine" id="cb4-42" data-line-number="42"><span class="co">#&gt; 2022-02-26 14:34:53 INFO::Fitting model to feature number 18, RPS4X</span></a>
<a class="sourceLine" id="cb4-43" data-line-number="43"><span class="co">#&gt; 2022-02-26 14:34:53 INFO::Fitting model to feature number 19, RPS14</span></a>
<a class="sourceLine" id="cb4-44" data-line-number="44"><span class="co">#&gt; 2022-02-26 14:34:53 INFO::Fitting model to feature number 20, RPS3A</span></a>
<a class="sourceLine" id="cb4-45" data-line-number="45"><span class="co">#&gt; 2022-02-26 14:34:54 INFO::Fitting model to feature number 21, EEF1A1</span></a>
<a class="sourceLine" id="cb4-46" data-line-number="46"><span class="co">#&gt; 2022-02-26 14:34:54 INFO::Fitting model to feature number 22, RPS27</span></a>
<a class="sourceLine" id="cb4-47" data-line-number="47"><span class="co">#&gt; 2022-02-26 14:34:54 INFO::Fitting model to feature number 23, RPL18A</span></a>
<a class="sourceLine" id="cb4-48" data-line-number="48"><span class="co">#&gt; 2022-02-26 14:34:54 INFO::Fitting model to feature number 24, RPS19</span></a>
<a class="sourceLine" id="cb4-49" data-line-number="49"><span class="co">#&gt; 2022-02-26 14:34:55 INFO::Fitting model to feature number 25, RPS27A</span></a>
<a class="sourceLine" id="cb4-50" data-line-number="50"><span class="co">#&gt; 2022-02-26 14:34:55 INFO::Fitting model to feature number 26, TPT1</span></a>
<a class="sourceLine" id="cb4-51" data-line-number="51"><span class="co">#&gt; 2022-02-26 14:34:55 INFO::Fitting model to feature number 27, RPL10A</span></a>
<a class="sourceLine" id="cb4-52" data-line-number="52"><span class="co">#&gt; 2022-02-26 14:34:55 INFO::Fitting model to feature number 28, RPS8</span></a>
<a class="sourceLine" id="cb4-53" data-line-number="53"><span class="co">#&gt; 2022-02-26 14:34:55 INFO::Fitting model to feature number 29, RPS5</span></a>
<a class="sourceLine" id="cb4-54" data-line-number="54"><span class="co">#&gt; 2022-02-26 14:34:55 INFO::Fitting model to feature number 30, RPL21</span></a>
<a class="sourceLine" id="cb4-55" data-line-number="55"><span class="co">#&gt; 2022-02-26 14:34:56 INFO::Fitting model to feature number 31, RPL15</span></a>
<a class="sourceLine" id="cb4-56" data-line-number="56"><span class="co">#&gt; 2022-02-26 14:34:56 INFO::Fitting model to feature number 32, RPL28</span></a>
<a class="sourceLine" id="cb4-57" data-line-number="57"><span class="co">#&gt; 2022-02-26 14:34:56 INFO::Fitting model to feature number 33, RPLP2</span></a>
<a class="sourceLine" id="cb4-58" data-line-number="58"><span class="co">#&gt; 2022-02-26 14:34:56 INFO::Fitting model to feature number 34, RPL34</span></a>
<a class="sourceLine" id="cb4-59" data-line-number="59"><span class="co">#&gt; 2022-02-26 14:34:56 INFO::Fitting model to feature number 35, RPS15A</span></a>
<a class="sourceLine" id="cb4-60" data-line-number="60"><span class="co">#&gt; 2022-02-26 14:34:57 INFO::Fitting model to feature number 36, LTB</span></a>
<a class="sourceLine" id="cb4-61" data-line-number="61"><span class="co">#&gt; 2022-02-26 14:34:57 INFO::Fitting model to feature number 37, TMSB10</span></a>
<a class="sourceLine" id="cb4-62" data-line-number="62"><span class="co">#&gt; 2022-02-26 14:34:57 INFO::Fitting model to feature number 38, RPL8</span></a>
<a class="sourceLine" id="cb4-63" data-line-number="63"><span class="co">#&gt; 2022-02-26 14:34:57 INFO::Fitting model to feature number 39, RPL23A</span></a>
<a class="sourceLine" id="cb4-64" data-line-number="64"><span class="co">#&gt; 2022-02-26 14:34:57 INFO::Fitting model to feature number 40, RPL14</span></a>
<a class="sourceLine" id="cb4-65" data-line-number="65"><span class="co">#&gt; 2022-02-26 14:34:57 INFO::Fitting model to feature number 41, MT-CO1</span></a>
<a class="sourceLine" id="cb4-66" data-line-number="66"><span class="co">#&gt; 2022-02-26 14:34:58 INFO::Fitting model to feature number 42, JUNB</span></a>
<a class="sourceLine" id="cb4-67" data-line-number="67"><span class="co">#&gt; 2022-02-26 14:34:58 INFO::Fitting model to feature number 43, RPL18</span></a>
<a class="sourceLine" id="cb4-68" data-line-number="68"><span class="co">#&gt; 2022-02-26 14:34:58 INFO::Fitting model to feature number 44, RPS7</span></a>
<a class="sourceLine" id="cb4-69" data-line-number="69"><span class="co">#&gt; 2022-02-26 14:34:58 INFO::Fitting model to feature number 45, RPL12</span></a>
<a class="sourceLine" id="cb4-70" data-line-number="70"><span class="co">#&gt; 2022-02-26 14:34:58 INFO::Fitting model to feature number 46, RPL6</span></a>
<a class="sourceLine" id="cb4-71" data-line-number="71"><span class="co">#&gt; 2022-02-26 14:34:59 INFO::Fitting model to feature number 47, RPL27A</span></a>
<a class="sourceLine" id="cb4-72" data-line-number="72"><span class="co">#&gt; 2022-02-26 14:34:59 INFO::Fitting model to feature number 48, RPL9</span></a>
<a class="sourceLine" id="cb4-73" data-line-number="73"><span class="co">#&gt; 2022-02-26 14:34:59 INFO::Fitting model to feature number 49, RPS16</span></a>
<a class="sourceLine" id="cb4-74" data-line-number="74"><span class="co">#&gt; 2022-02-26 14:34:59 INFO::Fitting model to feature number 50, RPL7A</span></a>
<a class="sourceLine" id="cb4-75" data-line-number="75"><span class="co">#&gt; 2022-02-26 14:34:59 INFO::Fitting model to feature number 51, RPS9</span></a>
<a class="sourceLine" id="cb4-76" data-line-number="76"><span class="co">#&gt; 2022-02-26 14:34:59 INFO::Fitting model to feature number 52, RPL7</span></a>
<a class="sourceLine" id="cb4-77" data-line-number="77"><span class="co">#&gt; 2022-02-26 14:35:00 INFO::Fitting model to feature number 53, RPSA</span></a>
<a class="sourceLine" id="cb4-78" data-line-number="78"><span class="co">#&gt; 2022-02-26 14:35:00 INFO::Fitting model to feature number 54, MT-CO2</span></a>
<a class="sourceLine" id="cb4-79" data-line-number="79"><span class="co">#&gt; 2022-02-26 14:35:01 INFO::Fitting model to feature number 55, RPL29</span></a>
<a class="sourceLine" id="cb4-80" data-line-number="80"><span class="co">#&gt; 2022-02-26 14:35:01 INFO::Fitting model to feature number 56, RPL5</span></a>
<a class="sourceLine" id="cb4-81" data-line-number="81"><span class="co">#&gt; 2022-02-26 14:35:01 INFO::Fitting model to feature number 57, GNB2L1</span></a>
<a class="sourceLine" id="cb4-82" data-line-number="82"><span class="co">#&gt; 2022-02-26 14:35:01 INFO::Fitting model to feature number 58, RPL30</span></a>
<a class="sourceLine" id="cb4-83" data-line-number="83"><span class="co">#&gt; 2022-02-26 14:35:01 INFO::Fitting model to feature number 59, CCL5</span></a>
<a class="sourceLine" id="cb4-84" data-line-number="84"><span class="co">#&gt; 2022-02-26 14:35:02 INFO::Fitting model to feature number 60, NACA</span></a>
<a class="sourceLine" id="cb4-85" data-line-number="85"><span class="co">#&gt; 2022-02-26 14:35:02 INFO::Fitting model to feature number 61, RPS23</span></a>
<a class="sourceLine" id="cb4-86" data-line-number="86"><span class="co">#&gt; 2022-02-26 14:35:02 INFO::Fitting model to feature number 62, HLA-C</span></a>
<a class="sourceLine" id="cb4-87" data-line-number="87"><span class="co">#&gt; 2022-02-26 14:35:02 INFO::Fitting model to feature number 63, RPS13</span></a>
<a class="sourceLine" id="cb4-88" data-line-number="88"><span class="co">#&gt; 2022-02-26 14:35:02 INFO::Fitting model to feature number 64, RPL26</span></a>
<a class="sourceLine" id="cb4-89" data-line-number="89"><span class="co">#&gt; 2022-02-26 14:35:03 INFO::Fitting model to feature number 65, HLA-A</span></a>
<a class="sourceLine" id="cb4-90" data-line-number="90"><span class="co">#&gt; 2022-02-26 14:35:03 INFO::Fitting model to feature number 66, RPS15</span></a>
<a class="sourceLine" id="cb4-91" data-line-number="91"><span class="co">#&gt; 2022-02-26 14:35:03 INFO::Fitting model to feature number 67, NKG7</span></a>
<a class="sourceLine" id="cb4-92" data-line-number="92"><span class="co">#&gt; 2022-02-26 14:35:03 INFO::Fitting model to feature number 68, RPS25</span></a>
<a class="sourceLine" id="cb4-93" data-line-number="93"><span class="co">#&gt; 2022-02-26 14:35:04 INFO::Fitting model to feature number 69, MT-CO3</span></a>
<a class="sourceLine" id="cb4-94" data-line-number="94"><span class="co">#&gt; 2022-02-26 14:35:04 INFO::Fitting model to feature number 70, FTL</span></a>
<a class="sourceLine" id="cb4-95" data-line-number="95"><span class="co">#&gt; 2022-02-26 14:35:04 INFO::Fitting model to feature number 71, PTMA</span></a>
<a class="sourceLine" id="cb4-96" data-line-number="96"><span class="co">#&gt; 2022-02-26 14:35:04 INFO::Fitting model to feature number 72, FOS</span></a>
<a class="sourceLine" id="cb4-97" data-line-number="97"><span class="co">#&gt; 2022-02-26 14:35:05 INFO::Fitting model to feature number 73, RPL4</span></a>
<a class="sourceLine" id="cb4-98" data-line-number="98"><span class="co">#&gt; 2022-02-26 14:35:05 INFO::Fitting model to feature number 74, RPL31</span></a>
<a class="sourceLine" id="cb4-99" data-line-number="99"><span class="co">#&gt; 2022-02-26 14:35:05 INFO::Fitting model to feature number 75, FTH1</span></a>
<a class="sourceLine" id="cb4-100" data-line-number="100"><span class="co">#&gt; 2022-02-26 14:35:06 INFO::Fitting model to feature number 76, EIF1</span></a>
<a class="sourceLine" id="cb4-101" data-line-number="101"><span class="co">#&gt; 2022-02-26 14:35:06 INFO::Fitting model to feature number 77, RPL35A</span></a>
<a class="sourceLine" id="cb4-102" data-line-number="102"><span class="co">#&gt; 2022-02-26 14:35:06 INFO::Fitting model to feature number 78, RPLP0</span></a>
<a class="sourceLine" id="cb4-103" data-line-number="103"><span class="co">#&gt; 2022-02-26 14:35:06 INFO::Fitting model to feature number 79, RPS10</span></a>
<a class="sourceLine" id="cb4-104" data-line-number="104"><span class="co">#&gt; 2022-02-26 14:35:07 INFO::Fitting model to feature number 80, EEF1D</span></a>
<a class="sourceLine" id="cb4-105" data-line-number="105"><span class="co">#&gt; 2022-02-26 14:35:07 INFO::Fitting model to feature number 81, H3F3B</span></a>
<a class="sourceLine" id="cb4-106" data-line-number="106"><span class="co">#&gt; 2022-02-26 14:35:07 INFO::Fitting model to feature number 82, ACTG1</span></a>
<a class="sourceLine" id="cb4-107" data-line-number="107"><span class="co">#&gt; 2022-02-26 14:35:08 INFO::Fitting model to feature number 83, S100A4</span></a>
<a class="sourceLine" id="cb4-108" data-line-number="108"><span class="co">#&gt; 2022-02-26 14:35:08 INFO::Fitting model to feature number 84, RPS20</span></a>
<a class="sourceLine" id="cb4-109" data-line-number="109"><span class="co">#&gt; 2022-02-26 14:35:08 INFO::Fitting model to feature number 85, RPL35</span></a>
<a class="sourceLine" id="cb4-110" data-line-number="110"><span class="co">#&gt; 2022-02-26 14:35:09 INFO::Fitting model to feature number 86, PFN1</span></a>
<a class="sourceLine" id="cb4-111" data-line-number="111"><span class="co">#&gt; 2022-02-26 14:35:09 INFO::Fitting model to feature number 87, MT-CYB</span></a>
<a class="sourceLine" id="cb4-112" data-line-number="112"><span class="co">#&gt; 2022-02-26 14:35:09 INFO::Fitting model to feature number 88, FAU</span></a>
<a class="sourceLine" id="cb4-113" data-line-number="113"><span class="co">#&gt; 2022-02-26 14:35:10 INFO::Fitting model to feature number 89, BTG1</span></a>
<a class="sourceLine" id="cb4-114" data-line-number="114"><span class="co">#&gt; 2022-02-26 14:35:10 INFO::Fitting model to feature number 90, UBA52</span></a>
<a class="sourceLine" id="cb4-115" data-line-number="115"><span class="co">#&gt; 2022-02-26 14:35:11 INFO::Fitting model to feature number 91, MT-ND2</span></a>
<a class="sourceLine" id="cb4-116" data-line-number="116"><span class="co">#&gt; 2022-02-26 14:35:11 INFO::Fitting model to feature number 92, SH3BGRL3</span></a>
<a class="sourceLine" id="cb4-117" data-line-number="117"><span class="co">#&gt; 2022-02-26 14:35:11 INFO::Fitting model to feature number 93, MT-ND4</span></a>
<a class="sourceLine" id="cb4-118" data-line-number="118"><span class="co">#&gt; 2022-02-26 14:35:12 INFO::Fitting model to feature number 94, ARHGDIB</span></a>
<a class="sourceLine" id="cb4-119" data-line-number="119"><span class="co">#&gt; 2022-02-26 14:35:12 INFO::Fitting model to feature number 95, RPL17</span></a>
<a class="sourceLine" id="cb4-120" data-line-number="120"><span class="co">#&gt; 2022-02-26 14:35:12 INFO::Fitting model to feature number 96, HLA-B</span></a>
<a class="sourceLine" id="cb4-121" data-line-number="121"><span class="co">#&gt; 2022-02-26 14:35:13 INFO::Fitting model to feature number 97, IL32</span></a>
<a class="sourceLine" id="cb4-122" data-line-number="122"><span class="co">#&gt; 2022-02-26 14:35:14 INFO::Fitting model to feature number 98, RPS28</span></a>
<a class="sourceLine" id="cb4-123" data-line-number="123"><span class="co">#&gt; 2022-02-26 14:35:14 INFO::Fitting model to feature number 99, RPL24</span></a>
<a class="sourceLine" id="cb4-124" data-line-number="124"><span class="co">#&gt; 2022-02-26 14:35:15 INFO::Fitting model to feature number 100, RPL27</span></a>
<a class="sourceLine" id="cb4-125" data-line-number="125"><span class="co">#&gt; 2022-02-26 14:35:15 INFO::Counting prevalence for each feature</span></a>
<a class="sourceLine" id="cb4-126" data-line-number="126"><span class="co">#&gt; 2022-02-26 14:35:15 INFO::Writing all results to file (ordered by increasing q-values): demo_output/PBMC/all_results.tsv</span></a>
<a class="sourceLine" id="cb4-127" data-line-number="127"><span class="co">#&gt; 2022-02-26 14:35:15 INFO::Writing the significant results (those which are less than or equal to the threshold of 0.050000 ) to file (ordered by increasing q-values): demo_output/PBMC/significant_results.tsv</span></a></code></pre></div>
</div>
<div id="output" class="section level2">
<h2>Output</h2>
<p>After computation, <code>PBMC</code> is a data frame containing coefficient estimates, p-values, and q-values (multiplicity-adjusted p-values) along with other parameter estimates from the fitted per-feature models. By default, p-values are adjusted with the Benjamini-Hochberg method.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Table with DE analysis results</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw">head</span>(PBMC)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt;   feature metadata value       coef     stderr          pval          qval</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; 1    NKG7 CellType   CD4 -3.9541371 0.12128381 2.502522e-175 2.502522e-173</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; 2   HLA-C CellType   CD4 -0.7701041 0.03795521  9.232466e-81  4.616233e-79</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; 3    CCL5 CellType   CD4 -2.5894002 0.13687002  1.637241e-71  5.457469e-70</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; 4     B2M CellType   CD4 -0.5336113 0.02830093  4.315976e-71  1.078994e-69</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; 5   HLA-A CellType   CD4 -0.5821755 0.04443511  3.798968e-37  7.597936e-36</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt; 6    PFN1 CellType   CD4 -0.6790992 0.05407065  2.036946e-34  3.394910e-33</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt;   base.model tweedie.index    N N.not.zero percent.zero</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt; 1       CPLM         1.264 1451        446           69</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt; 2       CPLM         1.445 1451       1439            1</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt; 3       CPLM         1.353 1451        551           62</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; 4       CPLM         1.761 1451       1451            0</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt; 5       CPLM         1.440 1451       1433            1</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt; 6       CPLM         1.317 1451       1384            5</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co"># How many significant at 5% FDR</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="kw">nrow</span>(PBMC[PBMC<span class="op">$</span>qval<span class="op">&lt;</span><span class="fl">0.05</span>,]) <span class="co"># 82</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co">#&gt; [1] 82</span></a></code></pre></div>
<p>Using the adjusted p-values, there are 82 genes significant at 5% FDR.</p>
</div>
<div id="session-information" class="section level2">
<h2>Session information</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">sessionInfo</span>()</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; R version 3.6.3 (2020-02-29)</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt; Platform: x86_64-apple-darwin15.6.0 (64-bit)</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt; Running under: macOS  10.16</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; Matrix products: default</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; locale:</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; attached base packages:</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; other attached packages:</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt;  [1] Seurat_3.2.3       forcats_0.5.1      stringr_1.4.0      dplyr_1.0.7       </span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt;  [5] purrr_0.3.4        readr_1.4.0        tidyr_1.1.3        tibble_3.1.3      </span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">#&gt;  [9] ggplot2_3.3.5      tidyverse_1.3.1    Tweedieverse_0.0.1</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="co">#&gt; loaded via a namespace (and not attached):</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="co">#&gt;   [1] minqa_1.2.4          Rtsne_0.15           colorspace_2.0-2    </span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="co">#&gt;   [4] deldir_0.2-9         ellipsis_0.3.2       ggridges_0.5.3      </span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="co">#&gt;   [7] fs_1.5.0             spatstat.data_1.7-0  rstudioapi_0.13     </span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="co">#&gt;  [10] leiden_0.3.7         listenv_0.8.0        ggrepel_0.9.1       </span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26"><span class="co">#&gt;  [13] fansi_0.5.0          lubridate_1.7.10     xml2_1.3.2          </span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27"><span class="co">#&gt;  [16] logging_0.10-108     codetools_0.2-16     splines_3.6.3       </span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28"><span class="co">#&gt;  [19] knitr_1.31           polyclip_1.10-0      jsonlite_1.7.2      </span></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="co">#&gt;  [22] broom_0.7.7          ica_1.0-2            cluster_2.1.0       </span></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="co">#&gt;  [25] dbplyr_2.1.1         png_0.1-7            uwot_0.1.10         </span></a>
<a class="sourceLine" id="cb6-31" data-line-number="31"><span class="co">#&gt;  [28] sctransform_0.3.2    shiny_1.6.0          compiler_3.6.3      </span></a>
<a class="sourceLine" id="cb6-32" data-line-number="32"><span class="co">#&gt;  [31] httr_1.4.2           backports_1.2.1      assertthat_0.2.1    </span></a>
<a class="sourceLine" id="cb6-33" data-line-number="33"><span class="co">#&gt;  [34] Matrix_1.2-18        fastmap_1.1.0        lazyeval_0.2.2      </span></a>
<a class="sourceLine" id="cb6-34" data-line-number="34"><span class="co">#&gt;  [37] cli_3.0.1            later_1.1.0.1        htmltools_0.5.1.1   </span></a>
<a class="sourceLine" id="cb6-35" data-line-number="35"><span class="co">#&gt;  [40] tools_3.6.3          rsvd_1.0.3           igraph_1.2.6        </span></a>
<a class="sourceLine" id="cb6-36" data-line-number="36"><span class="co">#&gt;  [43] coda_0.19-4          gtable_0.3.0         glue_1.4.2          </span></a>
<a class="sourceLine" id="cb6-37" data-line-number="37"><span class="co">#&gt;  [46] reshape2_1.4.4       RANN_2.6.1           spatstat_1.64-1     </span></a>
<a class="sourceLine" id="cb6-38" data-line-number="38"><span class="co">#&gt;  [49] Rcpp_1.0.7           biglm_0.9-2.1        scattermore_0.7     </span></a>
<a class="sourceLine" id="cb6-39" data-line-number="39"><span class="co">#&gt;  [52] cellranger_1.1.0     vctrs_0.3.8          nlme_3.1-144        </span></a>
<a class="sourceLine" id="cb6-40" data-line-number="40"><span class="co">#&gt;  [55] lmtest_0.9-38        xfun_0.20            globals_0.14.0      </span></a>
<a class="sourceLine" id="cb6-41" data-line-number="41"><span class="co">#&gt;  [58] rvest_1.0.0          mime_0.9             miniUI_0.1.1.1      </span></a>
<a class="sourceLine" id="cb6-42" data-line-number="42"><span class="co">#&gt;  [61] lifecycle_1.0.0      irlba_2.3.3          statmod_1.4.33      </span></a>
<a class="sourceLine" id="cb6-43" data-line-number="43"><span class="co">#&gt;  [64] goftest_1.2-2        future_1.21.0        MASS_7.3-51.5       </span></a>
<a class="sourceLine" id="cb6-44" data-line-number="44"><span class="co">#&gt;  [67] zoo_1.8-8            scales_1.1.1         spatstat.utils_2.0-0</span></a>
<a class="sourceLine" id="cb6-45" data-line-number="45"><span class="co">#&gt;  [70] hms_1.0.0            promises_1.1.1       parallel_3.6.3      </span></a>
<a class="sourceLine" id="cb6-46" data-line-number="46"><span class="co">#&gt;  [73] RColorBrewer_1.1-2   yaml_2.2.1           gridExtra_2.3       </span></a>
<a class="sourceLine" id="cb6-47" data-line-number="47"><span class="co">#&gt;  [76] reticulate_1.18      pbapply_1.4-3        rpart_4.1-15        </span></a>
<a class="sourceLine" id="cb6-48" data-line-number="48"><span class="co">#&gt;  [79] stringi_1.7.3        rlang_0.4.11         pkgconfig_2.0.3     </span></a>
<a class="sourceLine" id="cb6-49" data-line-number="49"><span class="co">#&gt;  [82] matrixStats_0.58.0   cplm_0.7-8           evaluate_0.14       </span></a>
<a class="sourceLine" id="cb6-50" data-line-number="50"><span class="co">#&gt;  [85] lattice_0.20-38      tensor_1.5           ROCR_1.0-11         </span></a>
<a class="sourceLine" id="cb6-51" data-line-number="51"><span class="co">#&gt;  [88] patchwork_1.1.1      htmlwidgets_1.5.3    cowplot_1.1.1       </span></a>
<a class="sourceLine" id="cb6-52" data-line-number="52"><span class="co">#&gt;  [91] tidyselect_1.1.0     parallelly_1.23.0    RcppAnnoy_0.0.18    </span></a>
<a class="sourceLine" id="cb6-53" data-line-number="53"><span class="co">#&gt;  [94] plyr_1.8.6           magrittr_2.0.1       R6_2.5.1            </span></a>
<a class="sourceLine" id="cb6-54" data-line-number="54"><span class="co">#&gt;  [97] generics_0.1.0       DBI_1.1.1            mgcv_1.8-31         </span></a>
<a class="sourceLine" id="cb6-55" data-line-number="55"><span class="co">#&gt; [100] pillar_1.6.2         haven_2.3.1          withr_2.4.2         </span></a>
<a class="sourceLine" id="cb6-56" data-line-number="56"><span class="co">#&gt; [103] fitdistrplus_1.1-3   abind_1.4-5          survival_3.2-11     </span></a>
<a class="sourceLine" id="cb6-57" data-line-number="57"><span class="co">#&gt; [106] future.apply_1.7.0   modelr_0.1.8         crayon_1.4.1        </span></a>
<a class="sourceLine" id="cb6-58" data-line-number="58"><span class="co">#&gt; [109] KernSmooth_2.23-16   utf8_1.2.2           plotly_4.9.3        </span></a>
<a class="sourceLine" id="cb6-59" data-line-number="59"><span class="co">#&gt; [112] rmarkdown_2.6        grid_3.6.3           readxl_1.3.1        </span></a>
<a class="sourceLine" id="cb6-60" data-line-number="60"><span class="co">#&gt; [115] data.table_1.13.6    reprex_2.0.0         digest_0.6.27       </span></a>
<a class="sourceLine" id="cb6-61" data-line-number="61"><span class="co">#&gt; [118] xtable_1.8-4         httpuv_1.5.5         stats4_3.6.3        </span></a>
<a class="sourceLine" id="cb6-62" data-line-number="62"><span class="co">#&gt; [121] munsell_0.5.0        tweedie_2.3.3        viridisLite_0.4.0</span></a></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
